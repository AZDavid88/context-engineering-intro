# Agentic Coding Constraints Framework

**Generated by**: CODEFARM Anti-Hallucination Roadmap Generator  
**Date**: 2025-08-02  
**Status**: Process-Enforcing Constraint System  
**Purpose**: Systematic prevention of agentic coding deviations through research-backed constraints

---

## üéØ CONSTRAINT FRAMEWORK OVERVIEW

This framework establishes **absolute constraints** for agentic coding systems to prevent hallucinations and ensure **systematic adherence** to validated research patterns. Every constraint is derived from **evidence-based research validation** and enforced through **systematic validation gates**.

---

## üîí APPROVED IMPLEMENTATION PATTERNS (MANDATORY)

### **1. GENETIC ALGORITHM IMPLEMENTATION CONSTRAINTS**

**Research Authority**: `/research/deap/research_summary.md`

#### **‚úÖ MANDATORY PATTERNS**

```python
# ‚úÖ REQUIRED: Module-level evaluation functions only
def evaluate_individual_fitness(individual, market_data):
    """
    CONSTRAINT: Must be module-level function for multiprocessing compatibility.
    RESEARCH SOURCE: /research/deap/4_multiprocessing_distributed_evaluation.md
    """
    # Implementation logic here
    return fitness_value,

# ‚úÖ REQUIRED: Standard DEAP toolbox registration
toolbox = base.Toolbox()
toolbox.register("evaluate", evaluate_individual_fitness, market_data=data)
toolbox.register("select", tools.selTournament, tournsize=3)
toolbox.register("mate", tools.cxTwoPoint)
toolbox.register("mutate", tools.mutGaussian, mu=0, sigma=0.1, indpb=0.1)

# ‚úÖ REQUIRED: Direct multiprocessing.Pool() usage
pool = multiprocessing.Pool()
toolbox.register("map", pool.map)
```

#### **‚ùå FORBIDDEN PATTERNS (HALLUCINATION SOURCES)**

```python
# ‚ùå FORBIDDEN: Lambda functions in DEAP
toolbox.register("evaluate", lambda ind: complex_fitness(ind, data))
# VIOLATION: Breaks multiprocessing serialization
# RESEARCH EVIDENCE: DEAP documentation explicitly prohibits lambdas

# ‚ùå FORBIDDEN: Custom genetic operators without DEAP validation
def custom_super_crossover(ind1, ind2):
    # Custom implementation
    pass
# VIOLATION: Not validated against DEAP research patterns

# ‚ùå FORBIDDEN: Async genetic algorithms
async def evolve_population_async():
    # Async implementation
    pass
# VIOLATION: DEAP does not support async operations

# ‚ùå FORBIDDEN: Custom serialization workarounds
def serialize_individual_custom(individual):
    # Custom serialization
    pass
# VIOLATION: Over-engineering not supported by DEAP research
```

### **2. HYPERLIQUID API INTEGRATION CONSTRAINTS**

**Research Authority**: `/research/hyperliquid_documentation/` + `/research/hyperliquid_python_sdk_v3_comprehensive/`

#### **‚úÖ MANDATORY PATTERNS**

```python
# ‚úÖ REQUIRED: Exact rate limit compliance
HYPERLIQUID_RATE_LIMITS = {
    "rest_requests_per_minute": 1200,  # FROM: 6_rate_limits_and_constraints.md
    "websocket_connections_per_ip": 100,  # FROM: 6_rate_limits_and_constraints.md
    "subscriptions_per_connection": 1000  # FROM: 6_rate_limits_and_constraints.md
}

# ‚úÖ REQUIRED: Documented subscription types only
class SubscriptionType(str, Enum):
    # FROM: research/hyperliquid_python_sdk_v3_comprehensive/vector2_api_specs.md
    ALL_MIDS = "allMids"
    L2_BOOK = "l2Book"
    TRADES = "trades"
    BBO = "bbo"
    CANDLES = "candles"
    # ... only documented types allowed

# ‚úÖ REQUIRED: Official environment URLs
HYPERLIQUID_ENVIRONMENTS = {
    "mainnet": "https://api.hyperliquid.xyz",  # FROM: research documentation
    "testnet": "https://api.hyperliquid-testnet.xyz"  # FROM: research documentation
}
```

#### **‚ùå FORBIDDEN PATTERNS (HALLUCINATION SOURCES)**

```python
# ‚ùå FORBIDDEN: Non-existent subscription types
CUSTOM_SIGNALS = "customSignals"  # NOT IN DOCUMENTATION
ADVANCED_ANALYTICS = "advancedAnalytics"  # NOT IN DOCUMENTATION

# ‚ùå FORBIDDEN: Rate limits exceeding documentation
CUSTOM_RATE_LIMIT = 5000  # EXCEEDS DOCUMENTED 1200/min LIMIT

# ‚ùå FORBIDDEN: Invented API endpoints
response = client.get("/api/v2/advanced_strategies")  # ENDPOINT DOESN'T EXIST

# ‚ùå FORBIDDEN: Custom authentication schemes
custom_auth = CustomHyperliquidAuth()  # NOT IN RESEARCH
```

### **3. PANDAS DATA PROCESSING CONSTRAINTS**

**Research Authority**: `/research/pandas_comprehensive/research_summary.md`

#### **‚úÖ MANDATORY PATTERNS**

```python
# ‚úÖ REQUIRED: Official pandas API patterns only
# FROM: research/pandas_comprehensive/page_1_series_rolling.md
df['SMA_20'] = df['close'].rolling(window=20).mean()
df['SMA_50'] = df['close'].rolling(window=50).mean()

# FROM: research/pandas_comprehensive/page_2_series_ewm.md
df['EMA_12'] = df['close'].ewm(span=12).mean()
df['EMA_26'] = df['close'].ewm(span=26).mean()

# FROM: research/pandas_comprehensive/page_3_series_diff_where_fillna_mean.md
df['price_change'] = df['close'].diff()
df['filtered_signal'] = df['close'].where(df['volume'] > threshold)
df['filled_prices'] = df['close'].fillna(method='ffill')

# ‚úÖ REQUIRED: Bollinger Bands calculation
df['BB_middle'] = df['close'].rolling(20).mean()
df['BB_std'] = df['close'].rolling(20).std()
df['BB_upper'] = df['BB_middle'] + (2 * df['BB_std'])
df['BB_lower'] = df['BB_middle'] - (2 * df['BB_std'])
```

#### **‚ùå FORBIDDEN PATTERNS (HALLUCINATION SOURCES)**

```python
# ‚ùå FORBIDDEN: Non-existent pandas methods
df['signal'] = df['close'].technical_analysis()  # METHOD DOESN'T EXIST
df['custom'] = df['close'].advanced_indicator()  # METHOD DOESN'T EXIST

# ‚ùå FORBIDDEN: Incorrect parameter names
df['ma'] = df['close'].rolling(window_size=20).mean()  # WRONG: use 'window'
df['ema'] = df['close'].ewm(period=12).mean()  # WRONG: use 'span'

# ‚ùå FORBIDDEN: pandas-ta library usage (not validated)
import pandas_ta as ta  # NOT VALIDATED IN RESEARCH
df['rsi'] = ta.rsi(df['close'])  # NOT USING VALIDATED PATTERNS

# ‚ùå FORBIDDEN: Custom fillna methods
df['filled'] = df['close'].fillna(method='interpolate_advanced')  # INVALID METHOD
```

### **4. MONITORING SYSTEM CONSTRAINTS**

**Research Authority**: `/research/prometheus_python_official/research_summary.md`

#### **‚úÖ MANDATORY PATTERNS**

```python
# ‚úÖ REQUIRED: Standard Prometheus metric types only
from prometheus_client import Counter, Histogram, Gauge, Summary

# FROM: research/prometheus_python_official/page_2_python_client_implementation.md
trades_counter = Counter('trades_total', 'Total number of trades executed')
request_latency = Histogram('api_request_duration_seconds', 'API request latency')
active_connections = Gauge('active_connections', 'Number of active connections')
processing_time = Summary('request_processing_seconds', 'Time spent processing requests')

# ‚úÖ REQUIRED: Standard metric operations
trades_counter.inc()  # Increment counter
request_latency.observe(response_time)  # Record histogram observation
active_connections.set(connection_count)  # Set gauge value
```

#### **‚ùå FORBIDDEN PATTERNS (HALLUCINATION SOURCES)**

```python
# ‚ùå FORBIDDEN: Non-existent Prometheus metric types
advanced_metric = AdvancedCounter('custom_metric')  # NOT A PROMETHEUS TYPE
super_gauge = SuperGauge('advanced_gauge')  # NOT A PROMETHEUS TYPE

# ‚ùå FORBIDDEN: Custom monitoring implementations
custom_monitor = CustomPrometheusClient()  # NOT IN RESEARCH
advanced_collector = AdvancedMetricCollector()  # NOT VALIDATED

# ‚ùå FORBIDDEN: Non-standard metric operations
trades_counter.advanced_increment()  # METHOD DOESN'T EXIST
request_latency.custom_observe()  # METHOD DOESN'T EXIST
```

---

## üö® INTERFACE VALIDATION CONSTRAINTS

### **GENETIC SEED REGISTRY CONSTRAINTS**

**Research Authority**: `/research/genetic_seeds_comprehensive/` + Code Analysis

#### **‚úÖ MANDATORY INTERFACE PATTERNS**

```python
# ‚úÖ REQUIRED: Validated registry interface methods
class SeedRegistry:
    def get_seeds_by_type(self, seed_type: SeedType) -> List[BaseSeed]:
        """VALIDATED: Method exists in actual implementation."""
        pass
    
    def get_all_seeds(self) -> Dict[str, BaseSeed]:
        """VALIDATED: Method exists in actual implementation."""
        pass

# ‚úÖ REQUIRED: Validated seed type enumeration
class SeedType(str, Enum):
    # FROM: base_seed.py actual implementation
    MOMENTUM = "momentum"
    MEAN_REVERSION = "mean_reversion"
    BREAKOUT = "breakout"
    RISK_MANAGEMENT = "risk_management"
    CARRY = "carry"
    ML_CLASSIFIER = "ml_classifier"
    VOLATILITY = "volatility"
    VOLUME = "volume"
    TREND_FOLLOWING = "trend_following"
```

#### **‚ùå FORBIDDEN INTERFACE PATTERNS (HALLUCINATION SOURCES)**

```python
# ‚ùå FORBIDDEN: Non-existent registry methods
registry.list_all_seeds()  # METHOD DOESN'T EXIST IN ACTUAL IMPLEMENTATION
registry.find_seeds_by_name()  # METHOD DOESN'T EXIST
registry.get_optimal_seeds()  # METHOD DOESN'T EXIST

# ‚ùå FORBIDDEN: Invalid seed types
seed_type = SeedType.ARBITRAGE  # NOT IN ACTUAL ENUM
seed_type = SeedType.HIGH_FREQUENCY  # NOT IN ACTUAL ENUM
seed_type = SeedType.MARKET_MAKING  # NOT IN ACTUAL ENUM

# ‚ùå FORBIDDEN: Direct seed instantiation
seed = MomentumSeed()  # SHOULD USE REGISTRY
strategy = CustomStrategy()  # NOT A VALIDATED PATTERN
```

---

## üîç RESEARCH CONSULTATION REQUIREMENTS

### **MANDATORY RESEARCH VALIDATION PROTOCOL**

#### **Before Any Implementation:**

1. **Technology Domain Identification**
   ```bash
   # REQUIRED: Identify relevant research directory
   find /workspaces/context-engineering-intro/projects/quant_trading/research/ -name "*[technology]*"
   
   # REQUIRED: Read research summary
   cat research/[technology]/research_summary.md
   ```

2. **Pattern Validation Requirements**
   ```markdown
   **MANDATORY CHECKS:**
   - [ ] API method exists in research documentation
   - [ ] Parameter names match research examples exactly
   - [ ] Import statements validated against research
   - [ ] Rate limits comply with documented constraints
   - [ ] Error handling follows research patterns
   ```

3. **Implementation Approval Criteria**
   ```markdown
   **REQUIRED FOR APPROVAL:**
   - [ ] 100% traceability to research documentation
   - [ ] Zero custom implementations without research backing
   - [ ] All interfaces match validated patterns
   - [ ] All dependencies approved in research
   ```

### **VALIDATION GATE ENFORCEMENT**

#### **Gate 1: Research Compliance**
```python
def validate_research_compliance(implementation):
    """
    CONSTRAINT: All implementations must pass research validation.
    REJECTION CRITERIA: Any deviation from research patterns.
    """
    if not has_research_backing(implementation):
        raise ValidationError("Implementation lacks research foundation")
    
    if not matches_research_patterns(implementation):
        raise ValidationError("Implementation deviates from research patterns")
    
    return ValidationSuccess("Research compliance verified")
```

#### **Gate 2: Anti-Hallucination Verification**
```python
def validate_anti_hallucination(code):
    """
    CONSTRAINT: Zero tolerance for hallucinated implementations.
    REJECTION CRITERIA: Any non-documented API usage.
    """
    hallucinations = detect_hallucinations(code)
    if hallucinations:
        raise HallucinationError(f"Detected: {hallucinations}")
    
    return ValidationSuccess("Zero hallucinations detected")
```

---

## üö´ FORBIDDEN IMPLEMENTATION CATEGORIES

### **1. CUSTOM FRAMEWORK IMPLEMENTATIONS**
```python
# ‚ùå FORBIDDEN: Custom genetic algorithms
class CustomGeneticAlgorithm:  # USE DEAP ONLY
    pass

# ‚ùå FORBIDDEN: Custom API clients
class CustomHyperliquidClient:  # USE VALIDATED PATTERNS ONLY
    pass

# ‚ùå FORBIDDEN: Custom monitoring systems
class CustomMonitoringFramework:  # USE PROMETHEUS ONLY
    pass
```

### **2. UNDOCUMENTED API USAGE**
```python
# ‚ùå FORBIDDEN: Non-existent endpoints
client.get("/api/v3/advanced_features")  # ENDPOINT DOESN'T EXIST

# ‚ùå FORBIDDEN: Invented parameters
client.subscribe("trades", advanced_mode=True)  # PARAMETER NOT DOCUMENTED

# ‚ùå FORBIDDEN: Custom rate limiting
time.sleep(random.uniform(0.1, 0.5))  # NOT ALIGNED WITH RESEARCH
```

### **3. NON-VALIDATED DEPENDENCIES**
```python
# ‚ùå FORBIDDEN: Undocumented libraries
import custom_trading_lib  # NOT IN RESEARCH
import experimental_api  # NOT VALIDATED
import pandas_ta  # NOT VALIDATED IN RESEARCH
```

---

## ‚ö° AUTOMATED CONSTRAINT ENFORCEMENT

### **Pre-Implementation Validation**
```python
def validate_before_implementation(technology, implementation_plan):
    """Automated pre-implementation validation."""
    research_path = f"/research/{technology}/"
    
    if not os.path.exists(research_path):
        raise ValidationError(f"No research documentation for {technology}")
    
    if not implementation_plan.has_research_references():
        raise ValidationError("Implementation plan lacks research references")
    
    return ValidationSuccess("Pre-implementation validation passed")
```

### **Runtime Pattern Detection**
```python
def detect_forbidden_patterns(code_content):
    """Detect forbidden implementation patterns."""
    forbidden_patterns = [
        r'lambda.*toolbox\.register',  # Lambda in DEAP
        r'custom_.*_client',  # Custom API clients
        r'pandas_ta\.',  # Non-validated pandas-ta
        r'\.custom_.*\(',  # Custom methods
    ]
    
    violations = []
    for pattern in forbidden_patterns:
        if re.search(pattern, code_content):
            violations.append(f"Forbidden pattern detected: {pattern}")
    
    return violations
```

### **Research Synchronization Monitoring**
```python
def monitor_research_alignment():
    """Monitor ongoing alignment with research documentation."""
    implementation_files = get_all_implementation_files()
    research_files = get_all_research_files()
    
    alignment_score = calculate_alignment(implementation_files, research_files)
    
    if alignment_score < 0.95:  # 95% minimum alignment
        raise AlignmentError(f"Research alignment below threshold: {alignment_score}")
    
    return AlignmentSuccess(f"Research alignment verified: {alignment_score}")
```

---

## üìä CONSTRAINT COMPLIANCE METRICS

### **Success Criteria**
- **Research Traceability**: 100% of implementations traceable to research
- **Pattern Compliance**: Zero deviations from validated patterns
- **Interface Adherence**: 100% compliance with validated interfaces
- **Dependency Validation**: All dependencies research-approved
- **Hallucination Detection**: Zero false negatives, 100% detection rate

### **Monitoring and Reporting**
- **Daily**: Automated pattern validation scans
- **Weekly**: Research alignment verification
- **Monthly**: Constraint effectiveness assessment
- **Quarterly**: Framework evolution based on new research

---

**üéØ CONSTRAINT FRAMEWORK SUCCESS**: Systematic prevention of agentic coding deviations through research-enforced constraints, ensuring 100% compliance with validated patterns and zero tolerance for implementation hallucinations.